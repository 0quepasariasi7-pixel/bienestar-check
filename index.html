<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Essencia Vital | Decodifica tu Biolog√≠a</title>
    <style>
        :root {
            --primary: #4F46E5; 
            --primary-dark: #3730A3;
            --accent: #0D9488;  
            --bg-gradient: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
            --text-light: #F8FAFC;
            --text-gray: #94A3B8;
            --card-bg: rgba(30, 41, 59, 0.7);
            --white: #ffffff;
            --radius: 28px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg-gradient);
            margin: 0;
            height: 100dvh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            color: var(--text-light);
        }

        .progress-container {
            position: fixed;
            top: 0;
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.1);
            z-index: 10;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4F46E5, #0D9488);
            width: 0%;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .app-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
            width: 100%;
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            padding: 45px 35px;
            border-radius: var(--radius);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            width: 100%;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            animation: fadeIn 0.8s ease-out;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        .brand-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .dot { width: 12px; height: 12px; background: #0D9488; border-radius: 50%; box-shadow: 0 0 15px #0D9488; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        .brand-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.3em; color: #818CF8; font-weight: 800; }

        .question-text {
            font-size: 1.8rem;
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 15px;
            letter-spacing: -0.03em;
        }

        .subtitle { font-size: 1.05rem; color: var(--text-gray); margin-bottom: 30px; line-height: 1.6; }

        .insight-box {
            background: rgba(79, 70, 229, 0.15);
            border-left: 3px solid #818CF8;
            padding: 20px;
            border-radius: 4px 18px 18px 4px;
            font-size: 0.95rem;
            color: #C7D2FE;
            margin-bottom: 30px;
            line-height: 1.5;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn { from { transform: translateX(-10px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        .options-grid { display: flex; flex-direction: column; gap: 12px; }

        .btn-option {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            padding: 20px 24px;
            font-size: 1rem;
            font-weight: 600;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--white);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn-option:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #818CF8;
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #4F46E5, #6366F1);
            color: white;
            border: none;
            padding: 24px;
            border-radius: 22px;
            font-size: 1.2rem;
            font-weight: 700;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 15px 30px -10px rgba(79, 70, 229, 0.6);
        }

        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 20px 40px -10px rgba(79, 70, 229, 0.8); }

        .input-text {
            width: 100%;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 18px;
            font-size: 1rem;
            color: white;
            outline: none;
            margin-top: 15px;
        }

        .hidden { display: none; }
        .spinner { width: 24px; height: 24px; border: 3px solid rgba(255,255,255,0.2); border-top: 3px solid white; border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="app-container" id="app"></div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz_Rl8NFpEZJQI4rLlR-8ndkZ90WBuNZCV2M2qzGqjuc1sUZUyx6BEM4w7CthjyD92EGA/exec";
        const NO_APLICA = "No corresponde por perfil";

        const state = {
            step: 0,
            answers: {
                Fecha: '', Edad: '', Sexo: '', Trabajo: '', Pantalla: '',
                Energia: '', Sue√±o: '', Estres: '', Foco: '',
                Estres_Nocturno: NO_APLICA, Cambios_Humor: NO_APLICA,
                Fatiga_Mental: NO_APLICA, Lagunas_Mentales: NO_APLICA,
                Recuperacion: NO_APLICA, Molestias_Fisicas: NO_APLICA, Email: ''
            },
            queue: [],
            loading: false
        };

        const core = [
            { 
                id: 'welcome', 
                type: 'info', 
                title: '¬øVives o solo funcionas?', 
                subtitle: 'Tu cuerpo es un sistema complejo de se√±ales que la rutina te ha ense√±ado a ignorar. En Essencia Vital Biotech, decodificamos tu biograf√≠a silenciosa para desbloquear tu verdadera capacidad funcional.',
                btn: 'Decodificar mi Biolog√≠a' 
            },
            { 
                id: 'Edad', 
                type: 'choice', 
                title: 'Tu Arquitectura Celular', 
                subtitle: 'El tiempo no es lineal para tus c√©lulas. ¬øEn qu√© etapa de reconstrucci√≥n te encuentras?',
                options: [{l:'üê£ 18 a 34 a√±os', v:'18-34'}, {l:'üë®‚Äçüíª 35 a 44 a√±os', v:'35-44'}, {l:'üßò‚Äç‚ôÇÔ∏è 45 a 60 a√±os', v:'45-60'}, {l:'üåü M√°s de 60 a√±os', v:'Mas 60'}] 
            },
            { 
                id: 'Sexo', 
                type: 'choice', 
                title: 'Matriz Biol√≥gica', 
                subtitle: 'Cada organismo tiene ritmos y balances de absorci√≥n distintos. ¬øCu√°l es tu base?',
                options: [{l:'‚ôÄÔ∏è Perfil Femenino', v:'Femenino'}, {l:'‚ôÇÔ∏è Perfil Masculino', v:'Masculino'}, {l:'üîí Reservado', v:'No definido'}] 
            },
            { 
                id: 'Trabajo', 
                type: 'choice', 
                title: 'Entorno de Impacto', 
                subtitle: 'Tu actividad diaria es el mensaje m√°s fuerte que recibe tu metabolismo. ¬øC√≥mo te mueves?',
                options: [{l:'ü™ë Foco Sedentario', v:'Sedentario'}, {l:'üèÉ Flujo Din√°mico', v:'Mixto'}, {l:'üí™ Alto Rendimiento F√≠sico', v:'Fisico'}] 
            },
            { 
                id: 'Pantalla', 
                type: 'choice', 
                title: 'Interferencia Lum√≠nica', 
                subtitle: 'La luz artificial es un "hack" que altera tu reloj biol√≥gico. ¬øQu√© tan expuesto est√°s?',
                options: [{l:'üì± Baja (< 4h)', v:'Baja'}, {l:'üíª Media (4-8h)', v:'Media'}, {l:'üì° Cr√≠tica (> 8h)', v:'Alta'}] 
            },
            { 
                id: 'Energia', 
                type: 'choice', 
                title: 'Tu Potencial Mitocondrial', 
                subtitle: 'La energ√≠a no es caf√©; es eficiencia celular. ¬øC√≥mo calificar√≠as tu bater√≠a hoy?',
                insight: 'Poca energ√≠a suele significar que tus mitocondrias est√°n "estresadas" y no logran convertir nutrientes en vida.',
                options: [{l:'‚ö° Flujo Radiante', v:5}, {l:'üîã Sostenida', v:4}, {l:'üòê Intermitente', v:3}, {l:'üê¢ En reserva', v:2}] 
            },
            { 
                id: 'Sue√±o', 
                type: 'choice', 
                title: 'Fase de Restauraci√≥n', 
                subtitle: 'Al dormir, tu cerebro activa un sistema de "limpieza" profunda. ¬øQu√© tan efectivo es?',
                insight: 'Sin una limpieza profunda (sistema glinf√°tico), la inflamaci√≥n acumulada durante el d√≠a se queda en tu sistema.',
                options: [{l:'üõå Renovaci√≥n Total', v:'Excelente'}, {l:'üò¥ Descanso Est√°ndar', v:'Bueno'}, {l:'ü§î Reparaci√≥n Incompleta', v:'Regular'}, {l:'üò´ Falla de Recuperaci√≥n', v:'Malo'}] 
            },
            { 
                id: 'Estres', 
                type: 'choice', 
                title: 'Carga de Adaptaci√≥n', 
                subtitle: 'El estr√©s es una respuesta qu√≠mica antigua. ¬øCu√°nta presi√≥n percibe tu sistema?',
                insight: 'El cortisol elevado de forma cr√≥nica act√∫a como un "lanzallamas" silencioso para tus defensas.',
                options: [{l:'üßò Centro Calmo', v:2}, {l:'üòê Alerta Constante', v:3}, {l:'ü§Ø Estado de Alarma', v:5}] 
            },
            { 
                id: 'Foco', 
                type: 'choice', 
                title: 'Nitidez Cognitiva', 
                subtitle: 'Tu capacidad de atenci√≥n es el reflejo directo de tu salud cerebral inflamatoria.',
                options: [{l:'üéØ Enfoque L√°ser', v:'Alto'}, {l:'üí° Fluidez Normal', v:'Medio'}, {l:'üå´Ô∏è Niebla Mental', v:'Bajo'}] 
            }
        ];

        const deepDive = {
            estres: [
                { id: 'Estres_Nocturno', type: 'choice', title: 'El Ruido Nocturno', subtitle: '¬øTu mente se niega a pausar cuando buscas el silencio?', insight: 'Es tu cortisol intentando dominar la escena cuando deber√≠a estar dejando paso a la regeneraci√≥n.', options: [{l:'üåô S√≠, ruido persistente', v:'Si'}, {l:'‚úÖ No, silencio f√©rtil', v:'No'}] },
                { id: 'Cambios_Humor', type: 'choice', title: 'Olas Emocionales', subtitle: '¬øSientes mareas de √°nimo que parecen no tener una causa externa clara?', options: [{l:'üé¢ S√≠, a veces', v:'Si'}, {l:'üßò No, estabilidad', v:'No'}] }
            ],
            cognitivo: [
                { id: 'Fatiga_Mental', type: 'choice', title: 'Resistencia al L√≠mite', subtitle: '¬øTu cerebro se "apaga" antes de que tu cuerpo termine el d√≠a?', insight: 'El cerebro es el √≥rgano que m√°s consume ox√≠geno. La fatiga es su grito de auxilio por soporte celular.', options: [{l:'üß† S√≠, se agota pronto', v:'Si'}, {l:'üõ°Ô∏è No, resisto el ritmo', v:'No'}] },
                { id: 'Lagunas_Mentales', type: 'choice', title: 'Lapsos de Vac√≠o', subtitle: '¬øOlvidas detalles o sientes que tu presencia se fragmenta?', options: [{l:'üß† Sucede a veces', v:'Si'}, {l:'üõ°Ô∏è No, presencia plena', v:'No'}] }
            ],
            longevidad: [
                { id: 'Recuperacion', type: 'choice', title: 'Elasticidad Vital', subtitle: '¬øCon qu√© velocidad regresas a tu estado base tras un esfuerzo?', options: [{l:'üöÄ Retorno Veloz', v:'Rapida'}, {l:'üê¢ Inercia Lenta', v:'Lenta'}] },
                { id: 'Molestias_Fisicas', type: 'choice', title: 'Mensajes de Inflamaci√≥n', subtitle: '¬øHay zonas de tu cuerpo que siempre est√°n en tensi√≥n?', insight: 'El dolor sin golpe es inflamaci√≥n que ha echado ra√≠ces. No es "edad", es una se√±al funcional.', options: [{l:'ü§ï S√≠, detecto alarmas', v:'Si'}, {l:'‚ú® No, fluidez total', v:'No'}] }
            ]
        };

        function render() {
            const container = document.getElementById('app');
            const q = state.queue[state.step];
            const prog = (state.step / state.queue.length) * 100;
            document.getElementById('progressBar').style.width = `${prog}%`;

            if (!q) { renderFinal(); return; }

            let html = `<div class="card">
                <div>
                    <div class="brand-header"><div class="dot"></div><span class="brand-label">Capa 2: An√°lisis Funcional</span></div>
                    <div class="question-text">${q.title}</div>
                    <div class="subtitle">${q.subtitle || ''}</div>
                    ${q.insight ? `<div class="insight-box">‚ú¶ ${q.insight}</div>` : ''}
                </div>`;
            
            if (q.type === 'info') {
                html += `<button class="btn-primary" onclick="next()">${q.btn}</button>`;
            } else {
                html += `<div class="options-grid">`;
                q.options.forEach(o => {
                    html += `<button class="btn-option" onclick="save('${q.id}', '${o.v}')"><span>${o.l}</span><span>‚Üí</span></button>`;
                });
                html += `</div>`;
            }
            container.innerHTML = html + `</div>`;
        }

        function save(id, v) {
            state.answers[id] = v;
            if (id === 'Foco') {
                if (state.answers.Estres >= 4) state.queue.push(...deepDive.estres);
                if (state.answers.Foco === 'Bajo') state.queue.push(...deepDive.cognitivo);
                if (state.answers.Edad === '45-60' || state.answers.Edad === 'Mas 60') state.queue.push(...deepDive.longevidad);
            }
            next();
        }

        function next() { state.step++; render(); }

        function renderFinal() {
            document.getElementById('progressBar').style.width = `100%`;
            document.getElementById('app').innerHTML = `
                <div class="card">
                    <div>
                        <div class="brand-header"><div class="dot"></div><span class="brand-label">Integraci√≥n</span></div>
                        <div class="question-text">Tu perfil est√° listo</div>
                        <div class="subtitle">Hemos detectado los vectores que est√°n bloqueando tu potencial biol√≥gico. Ingresa tu contacto para recibir el Reporte de An√°lisis Funcional y la soluci√≥n personalizada.</div>
                        <div style="font-weight:700; margin-bottom:12px; font-size:0.8rem; color:#818CF8;">ACTIVAR REPORTE BIOTECNOL√ìGICO:</div>
                        <input type="email" id="mail" class="input-text" placeholder="nombre@email.com">
                    </div>
                    <button class="btn-primary" id="sendBtn" onclick="send()">
                        <span id="t">Obtener mi Perfil Funcional</span><span id="s" class="spinner hidden" style="margin: 0 auto;"></span>
                    </button>
                </div>`;
        }

        async function send() {
            if (state.loading) return;
            state.loading = true;
            document.getElementById('t').classList.add('hidden');
            document.getElementById('s').classList.remove('hidden');
            
            state.answers.Email = document.getElementById('mail').value || 'An√≥nimo';
            state.answers.Fecha = new Date().toLocaleString('es-ES');

            try {
                const params = new URLSearchParams(state.answers).toString();
                await fetch(`${SCRIPT_URL}?${params}`, { method: 'POST', mode: 'no-cors' });
            } catch (e) { console.error(e); }

            document.getElementById('app').innerHTML = `
                <div class="card" style="text-align:center; justify-content:center;">
                    <div style="font-size:5rem; margin-bottom:24px;">üß¨</div>
                    <div class="question-text">Conexi√≥n Establecida</div>
                    <div class="subtitle">Tus datos biol√≥gicos ya est√°n siendo procesados. En breve, recibir√°s en tu correo los lineamientos para recuperar tu equilibrio vital.</div>
                    <div class="insight-box" style="background:rgba(13, 148, 136, 0.1); border-color:#0D9488; color:#5EEAD4; font-style:normal;">
                        La consciencia de tu biolog√≠a es la llave de tu libertad. Bienvenido a Essencia Vital.
                    </div>
                </div>`;
        }

        state.queue = [...core];
        render();
    </script>
</body>
</html>
